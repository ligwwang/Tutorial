<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>fe08第17题</title>
        <style>
            .msg-error {
                color: red;
            }
        </style>
    </head>
    <body>
        <div id="id-div-form">
            <input id='id-input-name' type="text">
            <button id='id-button-login' type="button">登录</button>
        </div>
        <script>
                var button = document.querySelector('#id-button-login')
                button.addEventListener('click', function(){
                    var input = document.querySelector('#id-input-name')
                    var name = input.value
                    //get user name
                    //check
                    if (validate(name)) {
                        console.log('检查合格')
                    } else {
                        insertError()
                    }
                })

                var validate = function(s) {
                    var letters = 'abcdefghijklmnopqrstuvwxzABCDEFGHIJKLMNOPQRSTUVWXYZ'
                    var digits = '1234567890'
                    var validChar= true
                    var chars = letters + digits + '_'
                    for (var i = 0; i < s.length; i++) {
                        var char = s[i]
                        if (!chars.includes(char)) {
                            validChar = false
                        }
                    }
                    var validHead = letters.includes(s[0])
                    var validTail = s[s.length-1] != '_'
                    var validLength = s.length >= 2 && s.length <= 10
                    return validChar && validHead && validTail &&validLength
                }
                var insertError = function() {
                    var div = document.querySelector('#id-div-form')
                    var msg = '<h2 class="msg-error">用户名错误<h2>'
                    div.insertAdjacentHTML('beforeend', msg)
                }
        </script>
    </body>
</html>
